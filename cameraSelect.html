<!DOCTYPE html>
<html>
	<head>

    <!--
    AR.js Camera Selection Test
    Author: Matt Nutsch
    Date: 7-8-2018
    Description: This is test code for switching cameras in AR.js.
    
    Notes:
    This code is based in part on Jerome Etienne's examples of AR.js at: https://github.com/jeromeetienne/AR.js/tree/master/aframe
    It is also based in part on the AFrame documentation, available at: https://aframe.io/docs
    Download and print this image for the AR target marker: https://github.com/mnutsch/mnutsch.github.io/raw/master/arjs_workshop/start/Hiro%20pattern%20with%20border.pdf
    -->

    <!-- include a-frame -->
    <script src="https://mnutsch.github.io/arjs_workshop/start/vendor/aframe/build/aframe.min.js"></script>

    <!-- include ar.js for aframe -->
    <script src='https://mnutsch.github.io/arjs_workshop/start/vendor/arjs/build/aframe-ar.js'></script>
    <script>ARjs.Context.baseURL = 'https://mnutsch.github.io/arjs_workshop/start/vendor/three.js/'</script>
    <!-- Note: the above libraries are included with absolute URL's, because Github.io seems to prefer those. Change them to relative URL's -->

    <script>		
      //wait until the page loads to perform the following
      window.onload = function () 
      {
        
        function gotDevices(mediaDevices) {
          
          console.log("gotDevices ran!");

          //select.innerHTML = '';
          //select.appendChild(document.createElement('option'));
          let count = 1;
          mediaDevices.forEach(mediaDevice => {
            
            if (mediaDevice.kind === 'videoinput') {
              console.log("mediaDevice == ", mediaDevice);

              var option = document.createElement("option");
              option.text = mediaDevice.label || `Camera ${count}`;
              option.value = mediaDevice.deviceId;
              var select = document.getElementById("videoSelect");
              select.appendChild(option);
            
              /*
              const option = document.createElement('option');
              option.value = mediaDevice.deviceId;
              const label = mediaDevice.label || `Camera ${count  }`;
              const textNode = document.createTextNode(label);
              option.appendChild(textNode);
              select.appendChild(option);
              */
            }
            
          });
        }

        navigator.mediaDevices.enumerateDevices().then(gotDevices);

      }
    </script>

  </head>

  <!-- start the body of your page -->
  <body style='margin : 0px; overflow: hidden;'>
    <!-- add some info at the top of the page -->
    <div style='position: fixed; top: 10px; width:100%; text-align: center; z-index: 1; color: white;'>
      <select id = "videoSelect"></select>
    </div>    

    <!-- Define your 3d scene and enabled ar.js -->
    <a-scene debug embedded arjs='trackingMethod: best; debugUIEnabled: false;'>

      <!-- Create a anchor to attach your augmented reality -->
      <a-anchor hit-testing-enabled='true'>

        <!-- example of text fit onto a plane -->
        <a-plane
        geometry="primitive: plane; width: 1; height: 1; height: auto"
        material="opacity: 0.5; color: white;"
        position='0 0.25 3'>
          <a-entity id="planeText" scale='2 2 2' text="value: Hello Augmented Reality;" align-"center"></a-entity>
        </a-plane>

        <!-- Basic Box -->             
        <!-- see: https://aframe.io/docs/0.8.0 -->
        <a-box id="myBox" rotation="0 0 0" position='0 0.5 0' depth="1" height="1" width="1" material='opacity: 0.5; side:double; color:blue;'></a-box>
        
      </a-anchor>

      <!-- Define a static camera -->
      <a-camera-static/>

    </a-scene>

    <!-- add some info at the bottom left of the page -->
    <div >
      <span id="myText" style='z-index: 1; color: white; position: fixed; left: 50px; bottom: 10px;'>Add some text here.</span>
    </div>   

  </body>

</html>