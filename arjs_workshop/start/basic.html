<!DOCTYPE html>
<html>
	<head>

    <!--
    AR.js workshop
    Author: Matt Nutsch
    Date: 6-16-2018
    Description: This is sample code for a workshop on developing an AR.js app.
    Notes:
    This code is based in part on Jerome Etienne's examples of AR.js at: https://github.com/jeromeetienne/AR.js/tree/master/aframe
    It is also based in part on the AFrame documentation, available at: https://aframe.io/docs
    -->

    <!-- include a-frame -->
    <script src="https://mnutsch.github.io/arjs_workshop/start/vendor/aframe/build/aframe.min.js"></script>

    <!-- include ar.js for aframe -->
    <script src='https://mnutsch.github.io/arjs_workshop/start/vendor/arjs/build/aframe-ar.js'></script>
    <script>ARjs.Context.baseURL = 'https://mnutsch.github.io/arjs_workshop/start/vendor/three.js/'</script>

    <script>		
      //wait until the page loads to perform the following
      window.onload = function () 
      {
        //for keeping track of the date and time
        var today = new Date();
        var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
        var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
        var dateTime = date+' '+time;
      
        var intervalLength = 200; //determines the speed of the animation (milliseconds to wait between ticks)

        //define the scene
        var scene = document.querySelector('a-scene');       

        var myBoxPosition = {};
        myBoxPosition.x = 0;
        myBoxPosition.y = 0;
        myBoxPosition.z = 0;
        var myBox = document.getElementById('myBox');      
        var myText = document.getElementById('myText');      

        /*
        console.log("myBox == ", myBox);
        console.log("myBox.getAttribute('position') == ", myBox.getAttribute('position'));
        setTimeout(function(){   
          myBox.setAttribute('position', '0 1 0');
          //myBox['position'] = '0 1 0';
          console.log("myBox == ", myBox);
          console.log("myBox.getAttribute('position') == ", myBox.getAttribute('position'));
          scene.flushToDOM();
        }, 3000);
        setTimeout(function(){   
          myBox.setAttribute('position', '0 1.5 0');
          //myBox['position'] = '0 1.5 0';
          console.log("myBox == ", myBox);
          console.log("myBox.getAttribute('position') == ", myBox.getAttribute('position'));
          scene.flushToDOM();
        }, 6000);
        */
      
        //Timer for animations
        setInterval(function()
        {
          //ADD CODE HERE TO DO THINGS

          //move the box up
          myBoxPosition.y = myBoxPosition.y + 0.01;
          myBox.setAttribute('position', myBoxPosition.x + ' ' + myBoxPosition.y + ' ' + myBoxPosition.z);
          console.log("myBox.getAttribute('position') == ", myBox.getAttribute('position'));
          
          //get the current date and time          
          today = new Date();
          date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
          time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
          dateTime = date+' '+time;          
          //update the text entity's value to be this date and time
          myText.setAttribute('text', 'value: ' + dateTime);          

          //move the ball around
          //DEV NOTE: add code here

          //detect collisions
          //DEV NOTE: add code here
              
        }, intervalLength);

      }
    </script>

  </head>

  <!-- start the body of your page -->
  <body style='margin : 0px; overflow: hidden;'>
    <!-- add some info at the top of the page -->
    <div style='position: fixed; top: 10px; width:100%; text-align: center; z-index: 1; color: white;'>
      Instructions:<br/>
      Point your camera at the target marker.
    </div>    

    <!-- Define your 3d scene and enabled ar.js -->
    <a-scene debug embedded arjs='trackingMethod: best; debugUIEnabled: false;'>

      <!-- Declare assets for use in the scene. -->
      <a-assets timeout="1000">
        <!-- declare assets here -->    
      </a-assets>

      <!-- Create a anchor to attach your augmented reality -->
      <a-anchor hit-testing-enabled='true'>

        <!-- Add your static augmented reality items here -->

        <!-- Basic Text -->
        <!-- see: https://github.com/aframevr/aframe/blob/master/docs/components/text.md -->
        <!--<a-entity position='0 0 0' scale='5 5 5' color='red' text='value: Hello World;'></a-entity>-->

        <!-- Basic plane. -->
        <!-- see: https://aframe.io/docs/0.8.0 -->
        <!--<a-plane color="blue" height="1" width="1" rotation="-90 0 0"></a-plane>-->

        <!-- Text fit onto a plane -->
        <a-plane
        id = "helloWorldPlane"
        geometry="primitive: plane; width: 1; height: 1; height: auto"
        material="opacity: 0.5; color: white;"
        position='0 0.25 0'>
        <a-entity id = "myText" scale='1 1 1' text="value: Hello World;"></a-entity>
        </a-plane>

        <!-- Basic Box -->             
        <!-- see: https://aframe.io/docs/0.8.0 -->
        <a-box id="myBox" position='0 0.5 0' depth="1" height="1" width="1" material='opacity: 0.5; side:double; color:blue;'>          
        </a-box>        
      

      </a-anchor>

      <!-- Define a static camera -->
      <a-camera-static/>

    </a-scene>


  </body>

</html>
